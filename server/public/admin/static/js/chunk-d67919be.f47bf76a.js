(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d67919be"],{"01ea":function(t,e){t.exports={LIMIT_UPLOAD_SIZE:5}},"08f3":function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return r})),i.d(e,"c",(function(){return n}));var l=function(t,e){return{key:t,value:e}},a=[l(-1,"已删除"),l(0,"待审核"),l(1,"正常"),l(2,"审核未通过"),l(3,"隐藏")],r=[l(0,"封禁"),l(1,"正常")],n=[l(0,"隐藏"),l(1,"显示")]},"1f53":function(t,e,i){},2619:function(t,e,i){"use strict";i("1f53")},2909:function(t,e,i){"use strict";function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,l=new Array(e);i<e;i++)l[i]=t[i];return l}function a(t){if(Array.isArray(t))return l(t)}function r(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function n(t,e){if(t){if("string"===typeof t)return l(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?l(t,e):void 0}}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t){return a(t)||r(t)||n(t)||o()}i.d(e,"a",(function(){return s}))},"333b":function(t,e,i){"use strict";i("40f1")},"40f1":function(t,e,i){},6247:function(t,e,i){"use strict";var l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"selectImage"},[t.imgList.length?i("div",t._l(t.imgList,(function(e,l){return i("div",{key:l,staticClass:"imgBox",on:{click:function(e){t.visible=!0}}},[i("el-image",{staticClass:"smallImg",attrs:{src:t._f("imgUrl")(e),fit:"contain"}})],1)})),0):i("div",{staticClass:"imgBox",on:{click:function(e){t.visible=!0}}},[i("i",{staticClass:"el-icon-plus"})]),i("el-dialog",{attrs:{title:"选择图片",visible:t.visible,"append-to-body":""},on:{"update:visible":function(e){t.visible=e}}},[i("el-tabs",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],on:{"tab-click":t.handleTabClick},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[i("el-tab-pane",{attrs:{label:"外链图片",name:"link"}},[i("el-input",{attrs:{placeholder:"请输入图片外链地址",size:"medium"},model:{value:t.linkImgUrl,callback:function(e){t.linkImgUrl=e},expression:"linkImgUrl"}})],1),i("el-tab-pane",{attrs:{label:"上传图片",name:"upload"}},[i("el-upload",{ref:"upload",attrs:{action:t.HOST+"/api/user/upload/image",name:"files",accept:"image/jpeg,image/png,image/gif,image/jpg,image/bmp",headers:t.headers,"list-type":"picture-card","auto-upload":!1,limit:t.uploadLimit,"on-change":t.handleOnChange,"on-preview":t.handlePictureCardPreview,"on-success":t.handleUploadSuccess,"on-error":t.handleUploadFail}},[i("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),i("el-tab-pane",{attrs:{label:"素材库",name:"store"}})],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.cancel}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确 定")])],1)],1),i("el-dialog",{attrs:{visible:t.dialogVisible,"append-to-body":""},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)},a=[],r=(i("ac6a"),i("6b54"),i("2909")),n=(i("c5f6"),i("01ea")),o={name:"selectImage",data:function(){return{visible:!1,activeTab:"link",linkImgUrl:"",dialogImageUrl:"",dialogVisible:!1,disabled:!1,fileList:[],imgList:[],loading:!1}},props:{uploadLimit:{type:Number,default:6},value:{type:[Array,String],default:""}},methods:{show:function(){this.visible=!0},confirm:function(){switch(this.activeTab){case"link":this.linkImgUrl&&(this.imgList=[this.linkImgUrl],this.$emit("input",this.linkImgUrl));break;case"upload":this.loading=!0,this.$refs.upload.submit();break}this.visible=!1},cancel:function(){this.visible=!1},handleTabClick:function(t){},handleOnChange:function(t,e){/(gif|jpg|jpeg|png|GIF|JPG|PNG|bmp|BMP)/.test(t.raw.type)?t.raw.size/1024/1024>n["LIMIT_UPLOAD_SIZE"]&&(this.$message.error("图片大小不能超过".concat(n["LIMIT_UPLOAD_SIZE"],"MB")),e.pop()):(this.$message.error("请选择图片文件"),e.pop()),this.fileList=e},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},handleUploadSuccess:function(t,e,i){var l;console.log(t,e,i),1==this.uploadLimit?this.imgList=[t.data[0]]:(l=this.imgList).push.apply(l,Object(r["a"])(t.data)),this.imgList.length==this.fileList.length&&(this.loading=!1,this.$emit("input",1==this.uploadLimit?this.imgList[0]:this.imgList))},handleUploadFail:function(t,e,i){console.log(t),this.$message.error(t.toString()),this.loading=!1}},computed:{headers:function(){return{Authorization:"Bearer "+this.$store.state.user.token}},HOST:function(){return this.$store.state.HOST}},watch:{value:{immediate:!0,handler:function(t,e){var i=this;""!=e||this.imgList.length||this.value&&(this.value instanceof Array?this.value.forEach((function(t){i.imgList.push(t)})):this.imgList.push(this.value))}}}},s=o,c=(i("333b"),i("2877")),u=Object(c["a"])(s,l,a,!1,null,"5890adfa",null);e["a"]=u.exports},"75e2":function(t,e,i){"use strict";i.r(e);var l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"crumbs"},[i("el-breadcrumb",{attrs:{separator:"/"}},[i("el-breadcrumb-item",[i("i",{staticClass:"el-icon-lx-cascades"}),t._v(" 信息块管理 ")])],1)],1),i("div",{staticClass:"container"},[i("div",{staticClass:"handle-box"},[i("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:t.getData}}),i("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){t.editVisible=!0}}},[t._v("添加")])],1),i("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:t.tableData,border:"","header-cell-class-name":"table-header","row-key":"_id"}},[i("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row;return[i("el-table",{staticClass:"table",attrs:{data:l.list,border:"","header-cell-class-name":"table-header","row-key":"name",size:"mini"}},[i("el-table-column",{attrs:{prop:"coverImg",width:"120px",align:"center",label:"封面"},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row;return[i("el-image",{staticStyle:{height:"100px",width:"100px"},attrs:{fit:"contain",src:t._f("imgUrl")(l.coverImg)}})]}}],null,!0)}),i("el-table-column",{attrs:{prop:"title",label:"标题",width:"120px"}}),i("el-table-column",{attrs:{prop:"url",label:"地址",width:"200px","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{prop:"desc",label:"描述","show-overflow-tooltip":""}})],1)]}}])}),i("el-table-column",{attrs:{prop:"title",label:"标题",align:"left"}}),i("el-table-column",{attrs:{prop:"name",label:"信息块名"}}),i("el-table-column",{attrs:{label:"状态",align:"center",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tag",{attrs:{type:1===e.row.status?"success":0===e.row.status?"danger":""}},[t._v(t._s(t.viewStatus(e.row)))])]}}])}),i("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(i){return t.handleEdit(e.$index,e.row)}}},[t._v("编辑")]),i("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(i){return t.handleDelete(e.row)}}},[t._v("删除")])]}}])})],1)],1),i("el-dialog",{attrs:{title:t.editMode?"编辑":"添加",visible:t.editVisible,width:"50%"},on:{"update:visible":function(e){t.editVisible=e}}},[i("el-form",{ref:"form",attrs:{model:t.form,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"标题",required:""}},[i("el-input",{attrs:{placeholder:""},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),i("el-form-item",{attrs:{label:"信息块名",required:""}},[i("el-input",{attrs:{placeholder:""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),i("el-form-item",{attrs:{label:"状态",required:""}},[i("el-select",{model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",t._n(e))},expression:"form.status"}},t._l(t.statusList,(function(t){return i("el-option",{key:t.key,attrs:{label:t.value,value:t.key}})})),1)],1),i("el-form-item",{attrs:{label:"列表"}},[i("el-table",{staticClass:"table",attrs:{data:t.form.list,border:"","header-cell-class-name":"table-header","row-key":"name",size:"mini"}},[i("el-table-column",{attrs:{prop:"coverImg",label:"封面",width:"70px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row;return[i("el-image",{staticStyle:{height:"50px",width:"50px"},attrs:{fit:"contain",src:t._f("imgUrl")(l.coverImg)}})]}}])}),i("el-table-column",{attrs:{prop:"title",label:"标题",width:"100px","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{prop:"url",label:"地址",width:"150px","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{prop:"order",label:"排序",width:"150px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row,a=e.$index;return[t.orderIndex!=a?i("span",{staticClass:"order",on:{click:function(e){t.orderIndex=a}}},[t._v(t._s(l.order||0))]):i("el-input-number",{attrs:{size:"mini",min:0,max:255},on:{blur:function(e){t.orderIndex=-1}},model:{value:l.order,callback:function(e){t.$set(l,"order",e)},expression:"row.order"}})]}}])}),i("el-table-column",{attrs:{prop:"desc",label:"描述","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{label:"操作",align:"center",width:"70px"},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row,a=e.$index;return[i("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(e){return t.handleEditItem(a,l)}}},[t._v("编辑")]),i("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(e){return t.handleDeleteItem(l,t.form)}}},[t._v("删除")])]}}])})],1)],1),i("el-divider"),i("el-form-item",{attrs:{label:"标题",required:""}},[i("el-input",{attrs:{placeholder:""},model:{value:t.form_temp.title,callback:function(e){t.$set(t.form_temp,"title",e)},expression:"form_temp.title"}})],1),i("el-form-item",{attrs:{label:"描述",required:""}},[i("el-input",{attrs:{placeholder:""},model:{value:t.form_temp.desc,callback:function(e){t.$set(t.form_temp,"desc",e)},expression:"form_temp.desc"}})],1),i("el-form-item",{attrs:{label:"地址",required:""}},[i("el-input",{attrs:{placeholder:""},model:{value:t.form_temp.url,callback:function(e){t.$set(t.form_temp,"url",e)},expression:"form_temp.url"}})],1),i("el-form-item",{attrs:{label:"排序",required:""}},[i("el-input-number",{attrs:{size:"mini",min:0,max:255},model:{value:t.form_temp.order,callback:function(e){t.$set(t.form_temp,"order",e)},expression:"form_temp.order"}})],1),i("el-form-item",{attrs:{label:"封面",required:""}},[i("SelectImage",{attrs:{uploadLimit:1},model:{value:t.form_temp.coverImg,callback:function(e){t.$set(t.form_temp,"coverImg",e)},expression:"form_temp.coverImg"}})],1),i("el-form-item",[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.handleAddList}},[t._v(t._s(t.editItem?"保存":"添加到列表"))])],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.editVisible=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.saveEdit}},[t._v("确 定")])],1)],1)],1)},a=[],r=(i("20d6"),i("7f7f"),i("ac6a"),i("7514"),i("b775")),n=function(t){return Object(r["a"])({url:"/admin/infoBlock/list",method:"get",params:t||{},showMsg:!1})},o=function(t){return Object(r["a"])({url:"/admin/infoBlock/add",method:"post",data:t||{}})},s=function(t){return Object(r["a"])({url:"/admin/infoBlock/edit",method:"post",data:t||{}})},c=function(t){return Object(r["a"])({url:"/infoBlock/role/del",method:"delete",data:{id:t}})},u=i("6247"),d=i("08f3");function m(){return{list:[]}}var f={name:"infoBlock",data:function(){return{query:{},tableData:[],editMode:!1,editVisible:!1,form:m(),form_temp:{},tempIndex:-1,editItem:!1,statusList:d["c"],orderIndex:-1}},created:function(){this.getData()},watch:{editVisible:function(t){t||(this.form=m(),this.form_temp={},this.editMode=!1,this.editItem=!1,this.orderIndex=-1)}},methods:{handleEditItem:function(t,e){for(var i in this.editItem=!0,this.tempIndex=t,e)this.$set(this.form_temp,i,e[i])},viewStatus:function(t){return d["c"].find((function(e){return e.key==t.status})).value},getData:function(){var t=this;n(this.query).then((function(e){var i=function t(e){e.forEach((function(e){e.isRights?e.disabled=!0:e.children&&t(e.children)}))};i(e.data),t.tableData=e.data}))},handleAddList:function(){var t=this.form_temp,e=t.title,i=t.desc,l=t.url,a=t.coverImg;if(e&&i&&l&&a)if(this.editItem){for(var r in this.form_temp)this.$set(this.form.list[this.tempIndex],r,this.form_temp[r]);for(var n in this.form_temp)this.$set(this.form_temp,n,"");this.editItem=!1}else for(var o in this.form.list.push({title:e,desc:i,url:l,coverImg:a}),this.form_temp)this.$set(this.form_temp,o,"")},handleEdit:function(t,e){this.form=e,this.editMode=!0,this.editVisible=!0},saveEdit:function(){var t=this,e=this.editMode?s:o;e(this.form).then((function(e){t.getData(),t.editVisible=!1}))},handleDelete:function(t){var e=this;this.$confirm("请确认是否删除信息块：".concat(t.name)).then((function(){c(t._id).then((function(t){e.getData()}))}))},handleDeleteItem:function(t,e){e.list.splice(e.list.findIndex((function(e){return e.name==t.name})),1)}},components:{SelectImage:u["a"]}},p=f,h=(i("2619"),i("2877")),b=Object(h["a"])(p,l,a,!1,null,"41e3ccc7",null);e["default"]=b.exports}}]);