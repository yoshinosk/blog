(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-281cd481"],{"08f3":function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return i}));var l=function(t,e){return{key:t,value:e}},n=[l(-1,"已删除"),l(0,"待审核"),l(1,"正常"),l(2,"审核未通过"),l(3,"隐藏")],r=[l(0,"封禁"),l(1,"正常")],i=[l(0,"隐藏"),l(1,"显示")]},1981:function(t,e,a){"use strict";a("8d2e")},"8d2e":function(t,e,a){},cc5e:function(t,e,a){"use strict";a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return i}));var l=a("b775"),n=function(t){return Object(l["a"])({url:"/admin/role/list",method:"get",params:t||{},showMsg:!1})},r=function(t){return Object(l["a"])({url:"/admin/role/add",method:"post",data:t||{}})},i=function(t){return Object(l["a"])({url:"/admin/role/edit",method:"post",data:t||{}})}},e382:function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-user"}),t._v(" 用户管理\n            ")])],1)],1),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("el-button",{staticClass:"handle-del mr10",attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:t.getData}}),a("el-select",{staticClass:"handle-select mr10",model:{value:t.query.status,callback:function(e){t.$set(t.query,"status",e)},expression:"query.status"}},t._l(t.userStatus,(function(t){return a("el-option",{key:t.value,attrs:{label:t.value,value:t.key}})})),1),a("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"昵称"},model:{value:t.query.searchKey,callback:function(e){t.$set(t.query,"searchKey",e)},expression:"query.searchKey"}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleSearch}},[t._v("搜索")])],1),a("el-table",{ref:"multipleTable",staticClass:"table",attrs:{data:t.tableData,border:"","header-cell-class-name":"table-header"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"_id",label:"ID",width:"55",align:"center"}}),a("el-table-column",{attrs:{label:"头像",align:"center"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("el-avatar",{staticClass:"table-td-thumb",attrs:{src:t.row.avatar,"preview-src-list":[t.row.avatar]}})]}}])}),a("el-table-column",{attrs:{prop:"nickname",label:"用户名",width:"150"}}),a("el-table-column",{attrs:{prop:"email",label:"邮箱",width:"150"}}),a("el-table-column",{attrs:{prop:"roles",label:"角色",formatter:t.roleFormat}}),a("el-table-column",{attrs:{prop:"exp",label:"经验",width:"50"}}),a("el-table-column",{attrs:{prop:"level.level",label:"等级",width:"50"}}),a("el-table-column",{attrs:{prop:"coin",label:"金币",width:"50"}}),a("el-table-column",{attrs:{prop:"lastLoginTime",label:"最后登录",formatter:t.dateFormat}}),a("el-table-column",{attrs:{prop:"registerTime",label:"注册时间",formatter:t.dateFormat}}),a("el-table-column",{attrs:{label:"状态",align:"center",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:1===e.row.status?"success":0===e.row.status?"danger":""}},[t._v(t._s(1==e.row.status?"正常":"封禁"))])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(a){return t.handleEdit(e.$index,e.row)}}},[t._v("编辑")])]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":t.query.pageIndex,"page-size":t.query.pageSize,total:t.pageTotal},on:{"current-change":t.handlePageChange}})],1)],1),a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{title:"编辑",visible:t.editVisible,width:"30%"},on:{"update:visible":function(e){t.editVisible=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"70px"}},[a("el-form-item",{attrs:{label:"ID"}},[a("el-input",{attrs:{disabled:""},model:{value:t.form._id,callback:function(e){t.$set(t.form,"_id",e)},expression:"form._id"}})],1),a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{attrs:{disabled:""},model:{value:t.form.nickname,callback:function(e){t.$set(t.form,"nickname",e)},expression:"form.nickname"}})],1),a("el-form-item",{attrs:{label:"经验值"}},[a("el-input",{model:{value:t.form.exp,callback:function(e){t.$set(t.form,"exp",t._n(e))},expression:"form.exp"}})],1),a("el-form-item",{attrs:{label:"金币"}},[a("el-input",{model:{value:t.form.coin,callback:function(e){t.$set(t.form,"coin",t._n(e))},expression:"form.coin"}})],1),a("el-form-item",{attrs:{label:"角色组"}},[a("el-select",{attrs:{multiple:!0},model:{value:t.form.roles,callback:function(e){t.$set(t.form,"roles",e)},expression:"form.roles"}},t._l(t.roleList,(function(t){return a("el-option",{key:t._id,attrs:{label:t.title,value:t.name}})})),1)],1),a("el-form-item",{attrs:{label:"账号状态"}},[a("el-select",{model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},t._l(t.userStatus,(function(t){return a("el-option",{key:t.value,attrs:{label:t.value,value:t.key}})})),1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.editVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.saveEdit}},[t._v("确 定")])],1)],1)],1)},n=[],r=(a("7f7f"),a("b775")),i=function(t){return Object(r["a"])({url:"/admin/user/list",method:"get",params:t||{},showMsg:!1})},o=function(t){return Object(r["a"])({url:"/admin/user/edit",method:"post",data:t,showMsg:!0})},s=a("cc5e"),c=a("3de1"),u=a("08f3"),d={name:"basetable",data:function(){return{query:{page:1,pageSize:10},tableData:[],multipleSelection:[],delList:[],editVisible:!1,pageTotal:0,form:{},idx:-1,id:-1,roleList:[],userStatus:u["b"],loading:!1}},created:function(){var t=this;this.getData(),Object(s["c"])().then((function(e){var a=e.data;t.roleList=a}))},methods:{roleFormat:function(t){return t.roles.map((function(t){return t.title})).join(";")},dateFormat:function(t,e){return Object(c["a"])(t[e.property])},getData:function(){var t=this;i(this.query).then((function(e){var a=e.data;t.tableData=a.list,t.pageTotal=a.total}))},handleSearch:function(){this.$set(this.query,"page",1),this.getData()},handleDelete:function(t,e){var a=this;this.$confirm("确定要删除吗？","提示",{type:"warning"}).then((function(){a.$message.success("删除成功"),a.tableData.splice(t,1)})).catch((function(){}))},handleSelectionChange:function(t){this.multipleSelection=t},delAllSelection:function(){var t=this.multipleSelection.length,e="";this.delList=this.delList.concat(this.multipleSelection);for(var a=0;a<t;a++)e+=this.multipleSelection[a].name+" ";this.$message.error("删除了".concat(e)),this.multipleSelection=[]},handleEdit:function(t,e){for(var a in this.idx=t,this.editVisible=!0,e)"roles"==a?this.$set(this.form,a,e[a].map((function(t){return t.name}))):this.$set(this.form,a,e[a])},saveEdit:function(){var t=this;this.loading=!0,this.editVisible=!1,o(this.form).then((function(e){t.loading=!1,t.getData()}))},handlePageChange:function(t){this.$set(this.query,"pageIndex",t),this.getData()}}},m=d,f=(a("1981"),a("2877")),p=Object(f["a"])(m,l,n,!1,null,"291adb8e",null);e["default"]=p.exports}}]);